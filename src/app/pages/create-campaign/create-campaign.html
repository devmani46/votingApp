<app-burger-menu></app-burger-menu>

<div class="campaign-container">
  <div class="header">
    <img class="admin-photo" src="/assets/admin.png" alt="Admin" />
    <h2>Create Campaign</h2>
  </div>

  <form [formGroup]="form" (ngSubmit)="submitForm()">
    <app-fui-input formControlName="title" placeholder="Campaign Title"></app-fui-input>

    <textarea
      class="description-box"
      formControlName="description"
      placeholder="Campaign Description"
    ></textarea>

    <div class="row">
      <label>Campaign Logo:</label>
      <input type="file" accept="image/*" (change)="onLogoSelected($event)" hidden #logoInput />
      <app-button appearance="primary" (click)="logoInput.click()">Choose File</app-button>
    </div>

    @if (logoPreview) {
      <div class="logo-preview">
        <img [src]="logoPreview" alt="Campaign Logo" />
      </div>
    }

    <div class="row">
      <label>Candidates</label>
      <app-button appearance="primary" (click)="openDialog()">Add</app-button>
    </div>

    <div class="candidates-list">
      @for (c of candidates; track c.name) {
        <div class="candidate-card">
          <img [src]="c.photo" alt="Candidate" class="candidate-photo" />
          <div class="candidate-info">
            <h4>{{ c.name }}</h4>
            <p>{{ c.bio }}</p>
            <ul>
              @for (p of c.properties; track p) {
                <li>{{ p }}</li>
              }
            </ul>
          </div>
        </div>
      }
    </div>

    @if (showDialog) {
      <div class="dialog">
        <div class="dialog-content">
          <h3>Add Candidate</h3>

          <div class="candidate-form">
            <div class="candidate-photo-upload">
              <input type="file" accept="image/*" (change)="onCandidatePhotoSelected($event)" hidden #candidateFile />
              <app-button appearance="secondary" (click)="candidateFile.click()">Choose Photo</app-button>
              @if (candidatePhotoPreview) {
                <img [src]="candidatePhotoPreview" alt="Candidate Photo" />
              }
            </div>

            <div class="candidate-details">
              <app-fui-input [formControl]="nameControl" placeholder="Name"></app-fui-input>

              <textarea
                class="bio-box"
                [formControl]="bioControl"
                placeholder="Bio"
              ></textarea>

              <div class="properties">
                <div class="row">
                  <app-fui-input [formControl]="propertyControl" placeholder="Property"></app-fui-input>
                  <app-button appearance="primary" (click)="addProperty()">Add</app-button>
                </div>

                <ul>
                  @for (p of candidateProperties; track p) {
                    <li>{{ p }}</li>
                  }
                </ul>
              </div>
            </div>

          </div>

          <div class="dialog-actions">
            <app-button appearance="secondary" (click)="closeDialog()">Cancel</app-button>
            <app-button appearance="primary" (click)="saveCandidate()">Save</app-button>
          </div>
        </div>
      </div>
    }

    <div class="row">
      <label>Start Date:</label>
      <input type="date" formControlName="startDate" />
      <label>End Date:</label>
      <input type="date" formControlName="endDate" />
    </div>

    <app-button type="submit" appearance="primary">Submit</app-button>
  </form>
</div>
