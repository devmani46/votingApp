<div class="user-management">
  <div class="header">
    <app-burger-menu></app-burger-menu>
    <h2>User Management</h2>
    <img class="admin-photo" src="/assets/admin.png" alt="Admin" />
  </div>

  <!-- Moderators Section -->
  <div class="section">
    <div class="section-header">
      <h3>Moderators</h3>
      <app-button appearance="primary" (click)="openDialog()">Add Moderator</app-button>
    </div>

    <div class="moderator-list">
      @for (mod of moderators; let i = $index; track i) {
      <div class="moderator-card">
        <div class="info">
          <p><strong>{{ mod.name }}</strong></p>
          <p>{{ mod.email }}</p>
        </div>
        <div class="actions">
          <app-button size="small" appearance="secondary" (click)="openDialog(i)">Edit</app-button>
          <app-button size="small" appearance="primary" (click)="deleteModerator(i)">Delete</app-button>
        </div>
      </div>
      }
    </div>
  </div>

  <!-- Users Section -->
  <div class="section">
    <div class="section-header">
      <h3>Users (Voters)</h3>
    </div>

    <div class="user-list">
      @if (users.length === 0) {
        <p>No users yet (coming from backend later).</p>
      } @else {
        @for (u of users; let i = $index; track i) {
        <div class="user-card">
          <p><strong>{{ u.name }}</strong> ({{ u.email }})</p>
        </div>
        }
      }
    </div>
  </div>

  <!-- Dialog for Add/Edit Moderator -->
  @if (showDialog) {
  <div class="dialog-backdrop" (click)="closeDialogOnBackdrop($event)">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      <h3>{{ editIndex !== null ? "Edit Moderator" : "Add Moderator" }}</h3>

      <div class="moderator-form">
        <label>Name</label>
        <app-fui-input [formControl]="nameControl" placeholder="Moderator Name"></app-fui-input>

        <label>Email</label>
        <app-fui-input [formControl]="emailControl" placeholder="Moderator Email"></app-fui-input>

        <label>Password</label>
        <app-fui-input [formControl]="passwordControl" type="password" placeholder="Password"></app-fui-input>
      </div>

      <div class="dialog-actions">
        <app-button appearance="secondary" (click)="closeDialog()">Cancel</app-button>
        <app-button appearance="primary" (click)="saveModerator()">Save</app-button>
      </div>
    </div>
  </div>
  }
</div>
